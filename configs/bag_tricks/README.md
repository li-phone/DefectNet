# Bag Tricks

## Train and Test

    cd tools
    # ln -s {data directory} data 
    python bag_tricks_demo.py
    # wait...

## Results

Test on GTX 2080Ti GPU: 

#### **Fabric defect dataset**

- **Multi-scale Training**

|Input Size            | mAP    | AP@.5   | 
|:------------:|:--------:|:--------:|
|(1333, 800)                         |  0.203 | 0.434 | 
|(1223, 500)                         |  0.199 | 0.427 | 
|(2446, 1000)                        |  0.179 | 0.380 | 
|*Value*({(1223, 500), (1333, 800), (2446, 1000)})| 0.210 | 0.448 |
|*Range*(([1223, 2446], [500, 1000]))| **0.225** | **0.472** |
|*Range*(([667, 2000], [400, 1200]))| 0.220 | 0.454 |

<!-- 
|*Value*({(1223, 500), (1333, 800)})*| 0.213 | 0.447 |
|*Range*(([1223, 1333], [500, 800]))*| 0.220 | 0.455 | 
|*Range*(([612, 1835], [250, 750]))|  |  | 
-->

- **Dimension Clustering**

|k      | Anchor Ratio  |    Average IoU    |     mAP    | AP@.5   | 
|:------------:|:--------:|:--------:|:--------:|:--------:|
|3 | [0.21, 0.32, 1.83]       |     44.27     | 0.215 | 0.453 | 
|4 | [0.16, 0.30, 0.92, 3.62]  | 48.42 | 0.250| 0.525|
|5 | [0.05, 0.31, 0.92, 3.66, 8.04] | 53.93 | 0.272 | 0.543 |
|6 | [0.05, 0.19, 0.41, 1.00, 3.92, 8.07] | 56.64 | 0.266 | 0.542 |
|7 | [0.04, 0.18, 0.40, 0.77, 2.45, 5.25, 8.12] | 58.87 | 0.269 | 0.544 |
|8 | [0.04, 0.14, 0.29, 0.52, 0.85, 2.73, 5.77, 8.14] | 60.90 | **0.274** | 0.546 |
|9 | [0.04, 0.13, 0.28, 0.48, 0.73, 0.88, 2.91, 5.91, 8.17]| 62.21 | **0.274** | **0.549** |
|10| [0.04, 0.12, 0.20, 0.40, 0.50, 0.82, 1.30, 3.82, 5.93, 8.08]| **63.67** | 0.271 | 0.540 |

- **Soft-NMS With IoU Threshold**

|IoU Threshold            | mAP    | AP@.5   | 
|:------------:|:--------:|:--------:|
| 0.1 | 0.208 | **0.437** | 
| 0.2 | 0.208 | **0.437** | 
| 0.3 | 0.208 | 0.436 | 
| 0.4 | **0.209** | **0.437** | 
| 0.5 | 0.208 | **0.437** | 
| 0.6 | 0.207 | 0.434 | 
| 0.7 | 0.206 | 0.429 | 
| 0.8 | 0.202 | 0.414 | 
| 0.9 | 0.187 | 0.368 | 

- **Stacking Tricks**

|IoU Threshold            | mAP    | AP@.5   | 
|:------------|:--------:|:--------:|
| Baseline |   0.203 | 0.434 | 
| Baseline+Multi-scale | 0.225 | 0.472 | 
| Baseline+Multi-scale+Dimension Clustering |  |  | 
| Baseline+Multi-scale+Dimension Clustering+Soft-NMS |  |  | 

## License

This project is released under the [Apache 2.0 license](LICENSE).

## Changelog

None

## Reference

- **MMDetection**

    https://github.com/open-mmlab/mmdetection
